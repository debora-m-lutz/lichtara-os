name: Spiritual-Technical Alignment Check

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  alignment-check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Spiritual-Technical Alignment Verification
        run: |
          echo "üåü Checking spiritual-technical alignment..."
          
          # Check repository structure for conscious integration principles
          echo "Verifying repository structure..."
          
          # Verify key directories exist
          REQUIRED_DIRS=(
            "00-overview:"
            "01-fundamentos:"
            "02-manual-aurora:"
            "03-tecnica:"
            "04-legal:"
            "05-ai:"
            "05-prototipos"
            "manuais"
          )
          
          STRUCTURE_VALID=true
          for dir in "${REQUIRED_DIRS[@]}"; do
            if [ ! -d "$dir" ]; then
              echo "‚ùå Missing directory: $dir"
              STRUCTURE_VALID=false
            fi
          done
          
          if [ "$STRUCTURE_VALID" = true ]; then
            echo "‚úÖ Repository structure maintains conscious integration principles"
          else
            echo "‚ùå Repository structure validation failed"
            exit 1
          fi
          
          # Check documentation for spiritual-technical integration
          echo "Verifying documentation integration..."
          
          DOC_VALID=true
          
          # Check main README for spiritual-technical content
          if grep -q -i "spiritual\|spirituality" README.md && grep -q -i "technical\|technology" README.md; then
            echo "‚úÖ Main README contains spiritual-technical integration"
          else
            echo "‚ùå Main README missing spiritual-technical integration"
            DOC_VALID=false
          fi
          
          # Check for bilingual support
          if grep -q "Portugu√™s" README.md && grep -q "English" README.md; then
            echo "‚úÖ Bilingual documentation support verified"
          else
            echo "‚ùå Bilingual documentation support missing"
            DOC_VALID=false
          fi
          
          # Check Aurora Mission content
          if grep -q -i "aurora" README.md; then
            echo "‚úÖ Aurora Mission content present in main documentation"
          else
            echo "‚ùå Aurora Mission content missing from main documentation"
            DOC_VALID=false
          fi
          
          if [ "$DOC_VALID" = true ]; then
            echo "‚úÖ Documentation supports both technical and spiritual aspects"
          else
            echo "‚ùå Documentation validation failed"
            exit 1
          fi
          
          # Verify Aurora Mission alignment
          echo "Verifying Aurora Mission alignment..."
          
          AURORA_VALID=true
          
          # Check for Aurora Manual directory
          if [ -d "02-manual-aurora:" ]; then
            echo "‚úÖ Aurora Manual directory exists"
          else
            echo "‚ùå Aurora Manual directory missing"
            AURORA_VALID=false
          fi
          
          # Check for mission statement
          if grep -q -i "mission\|miss√£o" README.md; then
            echo "‚úÖ Mission statement present"
          else
            echo "‚ùå Mission statement missing"
            AURORA_VALID=false
          fi
          
          # Check for conscious integration mentions
          if grep -q -i "conscious.*integration\|integra√ß√£o.*consciente" README.md; then
            echo "‚úÖ Conscious integration principles documented"
          else
            echo "‚ùå Conscious integration principles not documented"
            AURORA_VALID=false
          fi
          
          if [ "$AURORA_VALID" = true ]; then
            echo "üåÖ Aurora Mission alignment verified"
          else
            echo "‚ùå Aurora Mission alignment failed"
            exit 1
          fi
          
          echo ""
          echo "üåü Spiritual-Technical Alignment Check Complete ‚ú®"